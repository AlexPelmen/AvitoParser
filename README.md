# AvitoParser
Парсер объявлений avito без API, не требующий авторизации пользователя

Парсер объеявлений позволяет получить информацию о всех объявлениях по запросу (или нескольким запросам) без использования API авито. Например, если трубется получить полный список объявлний по запросу "гитара", парсер просканирует все объявления, доступные по данному запросу. Это может занять продолжительное время. Таймаут между запросами настраивается в конфиге.

## Использование

1. В файл config.json внести список запросов, которые мы парсим
```json
[
    {
        "city": "moskva",
        "category": "",
        "query": "dji mini 2"
    },

    {
        "city": "moskva",
        "category": "",
        "query": "go pro hero 9"
    },

    {
        "city": "moskva",
        "category": "",
        "query": "гитара"
    }
]
```

2. В файле constants.php внести изменения в соответствии с реквизитами доступа в вашу БД.
```php
const DB_LOGIN = "admin";
const DB_PASSWORD = "password";
const DB_HOST = "localhost";
const DB_DATABASE = "parseddata";
```
В базе данных должна быть таблица **ads_data**

3. Запустить сессию браузера Mink в консоле (без графики)
```bash
google-chrome-stable --disable-gpu --headless --remote-debugging-address=127.0.0.1 --remote-debugging-port=9222
```

4. Выполните **scan.php**

5. Для отслеживания процесса работы откройте logs/log.log
```bash
tail -f ./logs/log.log
```

При парсинге объявлений вероятно в лог упадет серия ошибок dublicate entry при записи в бд. Это связано с тем, что некоторые объявления могут быть показаны несколько раз. Отследить это при использовании авито пока не удалось. Вероятно это связано с VIP объявлениями.
Парсер прекратит работу, когда будут завершены все запросы из config.json. Объявления из других городов не затрагиваются
